# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- master

pool: 
  vmImage: windows-latest

steps:
#- task: JavaToolInstaller@0
#  inputs:
#    versionSpec: '8'
#    jdkArchitectureOption: 'x64'
#    cleanDestinationDirectory: true
#    jdkSourceOption: PreInstalled
- task: Maven@4
  inputs:
    mavenPomFile: 'sonarqube-scanner-maven/maven-multimodule/pom.xml'
    options: '-ntp -B'
#    javaHomeOption: 'JDKVersion'
#    jdkVersionOption: '1.8'
#    jdkArchitectureOption: 'x64'
    publishJUnitResults: true
    testResultsFiles: '**/surefire-reports/TEST-*.xml'
    goals: 'package'
    codeCoverageToolOption: 'jaCoCo'
    codeCoverageClassFilesDirectories: 
    codeCoverageSourceDirectories: 
    codeCoverageFailIfEmpty: false
    sonarQubeRunAnalysis: false
    sqMavenPluginVersionChoice: 'latest'
    isJacocoCoverageReportXML: true
- task: PublishCodeCoverageResults@2
  inputs:
    summaryFileLocation: "/home/vsts/work/1/s/sonarqube-scanner-maven/maven-multimodule/CCReport43F6D5EF/target/site/jacoco-aggregate"